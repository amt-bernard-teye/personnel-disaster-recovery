generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  PERSONNEL
}

enum AccountStatus {
  VERIFIED
  PENDING
  SUSPENDED
}

model User {
  id String @id
  name String
  email String
  image String?
  password String
  role Role
  accountStatus AccountStatus @default(PENDING)
  personnel Personnel?

  @@map("users")
}

enum Gender {
  MALE
  FEMALE
}

model Personnel {
  id Int @id @default(autoincrement())
  phoneNumber String
  houseNumber String
  gender Gender
  dob DateTime
  town String
  digitalAddress String
  userId String @unique
  user User @relation(fields: [userId], references: [id])
  status PersonnelStatus  @default(PENDING)
  availability AvailabilityStatus @default(AVAILABLE)
  personnelProfession PersonnelProfession?
  educationalBackground EducationalBackground?
  projects Project[]

  @@map("personnels")
}

enum PersonnelStatus {
  PENDING
  APPROVE
  DISAPPROVE
}

enum AvailabilityStatus {
  AVAILABLE
  UNAVAILABLE
}

model EmergencyType {
  id Int @id @default(autoincrement())
  name String
  status EmergencyTypeStatus @default(ACTIVE)
  professions Profession[]

  @@map("emergency_types")
}

enum EmergencyTypeStatus {
  ACTIVE
  REMOVED
}

model Profession {
  id Int @id @default(autoincrement())
  name String
  emergencyId Int
  emergency EmergencyType @relation(fields: [emergencyId], references: [id])
  personnnelProfession PersonnelProfession[]
  status AvailabilityStatus @default(AVAILABLE)

  @@map("professions")
}

model PersonnelProfession {
  employee_id String @id
  experienceYears Int
  employer_name String
  employer_email String
  personnelId Int @unique
  personnel Personnel @relation(fields: [personnelId], references: [id])
  professionId Int
  profession Profession @relation(fields: [professionId], references: [id])
  currrentPosition CurrentPosition

  @@map("personnnel_profession")
}

enum CurrentPosition {
  JUNIOR
  ASSOCIATE
  EXPERT
}

model EducationalBackground {
  id Int @id @default(autoincrement())
  qualification String
  studyField String
  personnelId Int @unique
  personnel Personnel @relation(fields: [personnelId], references: [id])
  graduationYear Int @map("graduation_year")

  @@map("educational_background")
}

model Project {
  id Int @id @default(autoincrement())
  title String
  description String
  personnelId Int
  personnel Personnel @relation(fields: [personnelId], references: [id])

  @@map("projects")
}
